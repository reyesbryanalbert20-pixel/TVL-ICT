<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <header class="header">
        <div class="logo"><a href="index.html">LCBA</a></div>
        <nav class="nav">
            <a href="ict-page.html">TVL-ICT</a>
            <a href="image-gallery.html">Image Gallery</a>
            <a href="video-gallery.html">Video Gallery</a>
            <a href="game.html">Games</a>
        </nav>
    </header>

    <div class="game-title">
        <h1>Welcome to TVL-ICT Games!</h1>
        <p>Play the classic Snake game below!</p>
    </div>

    <canvas id="gc" class="game-canvas" width="400" height="400"></canvas>

    <div class="keys">
        <a class="up arr" onclick="Snake.action('up')"><i class="chevron up"></i></a><br>
        <a class="left arr" onclick="Snake.action('left')"><i class="chevron left"></i></a>
        <a class="down arr" onclick="Snake.action('down')"><i class="chevron down"></i></a>
        <a class="right arr" onclick="Snake.action('right')"><i class="chevron right"></i></a>
    </div>

    <div id="gameOverScreen">
        <div id="finalScore"></div>
        <div id="topScoreDisplay"></div>
        <button onclick="Snake.reset()">Try Again</button>
    </div>

    <footer class="footer">
    <div class="footer-container">
        <div class="footer-box">
            <h3>TVL-ICT</h3>
            <p>
                Empowering students with practical ICT skills to build,
                innovate, and succeed in the digital world.
            </p>
        </div>
        <div class="footer-box">
            <h3>Quick Links</h3>
            <a href="main-page.html">About LCBA</a>
            <a href="ict-page.html">About TVL-ICT</a>
            <a href="image-gallery.html">Image Gallery</a>
            <a href="video-gallery.html">Video Gallery</a>
            <a href="game.html">Game</a>
        </div>
        <div class="footer-box">
            <h3>Contact</h3>
            <p>Email: info@lcba.edu</p>
            <p>Phone: 0961-074-5530</p>
        </div>
    </div>

    <div class="copyright">
        <p>Â© 2026 LCBA TVL-ICT. All Rights Reserved.</p>
    </div>
</footer>

    <script>
        var Snake = (function () {

            const INITIAL_TAIL = 4;
            var fixedTail = true;
            var intervalID;

            var tileCount = 10;
            var gridSize = 400 / tileCount;

            const INITIAL_PLAYER = { x: Math.floor(tileCount / 2), y: Math.floor(tileCount / 2) };
            var velocity = { x: 0, y: 0 };
            var player = { x: INITIAL_PLAYER.x, y: INITIAL_PLAYER.y };

            var walls = false;
            var fruit = { x: 1, y: 1 };
            var trail = [];
            var tail = INITIAL_TAIL;
            var points = 0;
            var pointsMax = 0;

            var ActionEnum = { 'none': 0, 'up': 1, 'down': 2, 'left': 3, 'right': 4 };
            Object.freeze(ActionEnum);
            var lastAction = ActionEnum.none;

            var canv, ctx;

            function setup() {
                canv = document.getElementById('gc');
                ctx = canv.getContext('2d');
                game.reset();
            }

            var game = {
                reset: function () {
                    document.getElementById('gameOverScreen').style.display = 'none';
                    tail = INITIAL_TAIL; points = 0;
                    velocity.x = 0; velocity.y = 0;
                    player.x = INITIAL_PLAYER.x; player.y = INITIAL_PLAYER.y;
                    trail = [{ x: player.x, y: player.y }];
                    lastAction = ActionEnum.none;
                    game.RandomFruit();
                },
                action: {
                    up: function () { if (lastAction != ActionEnum.down) { velocity.x = 0; velocity.y = -1; } },
                    down: function () { if (lastAction != ActionEnum.up) { velocity.x = 0; velocity.y = 1; } },
                    left: function () { if (lastAction != ActionEnum.right) { velocity.x = -1; velocity.y = 0; } },
                    right: function () { if (lastAction != ActionEnum.left) { velocity.x = 1; velocity.y = 0; } }
                },
                RandomFruit: function () {
                    fruit.x = Math.floor(Math.random() * tileCount);
                    fruit.y = Math.floor(Math.random() * tileCount);
                },
                loop: function () {
                    var stopped = velocity.x == 0 && velocity.y == 0;
                    player.x += velocity.x; player.y += velocity.y;

                    if (velocity.x == 0 && velocity.y == -1) lastAction = ActionEnum.up;
                    if (velocity.x == 0 && velocity.y == 1) lastAction = ActionEnum.down;
                    if (velocity.x == -1 && velocity.y == 0) lastAction = ActionEnum.left;
                    if (velocity.x == 1 && velocity.y == 0) lastAction = ActionEnum.right;

                    // background
                    ctx.fillStyle = 'rgba(40,40,40,0.8)';
                    ctx.fillRect(0, 0, canv.width, canv.height);

                    // wrap around
                    if (!walls) {
                        if (player.x < 0) player.x = tileCount - 1;
                        if (player.x >= tileCount) player.x = 0;
                        if (player.y < 0) player.y = tileCount - 1;
                        if (player.y >= tileCount) player.y = 0;
                    }

                    if (!stopped) { trail.push({ x: player.x, y: player.y }); while (trail.length > tail) trail.shift(); }

                    // draw snake
                    ctx.fillStyle = 'green';
                    for (var i = 0; i < trail.length - 1; i++) {
                        ctx.fillRect(trail[i].x * gridSize + 1, trail[i].y * gridSize + 1, gridSize - 2, gridSize - 2);
                        if (!stopped && trail[i].x == player.x && trail[i].y == player.y) {
                            SnakeGameOver();
                            return;
                        }
                    }
                    ctx.fillRect(trail[trail.length - 1].x * gridSize + 1, trail[trail.length - 1].y * gridSize + 1, gridSize - 2, gridSize - 2);

                    // fruit
                    if (player.x == fruit.x && player.y == fruit.y) {
                        if (!fixedTail) tail++;
                        points++; if (points > pointsMax) pointsMax = points;
                        game.RandomFruit();
                        while (trail.some(t => t.x == fruit.x && t.y == fruit.y)) game.RandomFruit();
                    }
                    ctx.fillStyle = 'red';
                    ctx.fillRect(fruit.x * gridSize + 1, fruit.y * gridSize + 1, gridSize - 2, gridSize - 2);

                    // score
                    ctx.fillStyle = 'white';
                    ctx.font = "bold 16px Helvetica";
                    ctx.fillText("points: " + points, 288, 40);
                    ctx.fillText("top: " + pointsMax, 292, 60);
                }
            }

            function SnakeGameOver() {
                document.getElementById('finalScore').textContent = "Your Score: " + points;
                document.getElementById('topScoreDisplay').textContent = "Top Score: " + pointsMax;
                document.getElementById('gameOverScreen').style.display = 'flex';
                velocity.x = 0;
                velocity.y = 0;
            }

            function keyPush(evt) {
                switch (evt.keyCode) {
                    case 37: game.action.left(); evt.preventDefault(); break;
                    case 38: game.action.up(); evt.preventDefault(); break;
                    case 39: game.action.right(); evt.preventDefault(); break;
                    case 40: game.action.down(); evt.preventDefault(); break;
                    case 32: Snake.pause(); evt.preventDefault(); break;
                    case 27: game.reset(); evt.preventDefault(); break;
                }
            }

            return {
                start: function (fps = 15) { window.onload = setup; intervalID = setInterval(game.loop, 1000 / fps); },
                loop: game.loop,
                reset: game.reset,
                stop: function () { clearInterval(intervalID); },
                setup: {
                    keyboard: function (state) { if (state) document.addEventListener('keydown', keyPush); else document.removeEventListener('keydown', keyPush); },
                    fixedTail: function (state) { fixedTail = state; },
                    wall: function (state) { walls = state; },
                    tileCount: function (size) { tileCount = size; gridSize = 400 / tileCount; }
                },
                action: function (act) { if (act == 'up') game.action.up(); if (act == 'down') game.action.down(); if (act == 'left') game.action.left(); if (act == 'right') game.action.right(); },
                pause: function () { velocity.x = 0; velocity.y = 0; }
            };

        })();

        Snake.start(8);
        Snake.setup.keyboard(true);
        Snake.setup.fixedTail(false);
    </script>

</body>
</html>